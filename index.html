<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Compositional Bandit Experiment">
    <meta name="author" content="Akshay Jagadish, Eric Schulz">
    <meta charset="utf-8">
    <title>Decision making experiment</title>

    <script src='https://cdn.firebase.com/js/client/1.1.1/firebase.js'></script>
    <script src="https://d3js.org/d3.v3.min.js" charset="utf-8"></script>
    <script src="https://code.jquery.com/jquery-1.11.1.min.js"></script> 
    <script src="https://code.jquery.com/ui/1.10.4/jquery-ui.min.js"></script> 
    <link href="https://code.jquery.com/ui/1.10.4/themes/ui-lightness/jquery-ui.css" rel="stylesheet" type="text/css">
    <link href="js/bootstrap.css" rel="stylesheet" type="text/css">

 </head>

<body>
<div class='container' style="width: 95%; height: 95%">
	<div id="page1" style="display:block;">
			<h1>Welcome to our online study on decision making</h1>
			
			This study is part of a research project conducted
			by the <a href="http://cpilab.org/" target="_blank">Computational Principles of Intelligence Group</a>
			at the Max Planck Institute for Biological Cybernetics in Tuebingen, Germany.<br><br>
			
			<!-- images of town + Institute here-->
			<span>
			  <img src="./figs/tuebingen.jpg" height="300px">
			  <img src="./figs/mpi.jpg" height="300px">
			  <figcaption>By Rabe! - Own work, CC BY-SA 3.0, https://commons.wikimedia.org/w/index.php?curid=33554043</figcaption>
			</span>
			<br>
			Your job will be to play an easy and fun game that we call <b>Bandit City!</b><br>
			
			To be eligible to participate, you MUST meet the following criteria:
			<ul>
			<li>18 years of age or older.</li>
			<li>Fluent speaker of English.</li>
			<li>Have not previously participated in this experiment.</li>
			</ul>
			<br>
			<b>Please use a device with a keyboard.
			Please do not accept this HIT if you are using a touch screen! It will not work!</b>
			
			<h2>Details</h2>
			<h3>How much time will it take and how much can you earn?</h3>
			The study will take <b>20-30 minutes</b>.<br>
			You will be paid $2.00 USD for participation plus a bonus of up to $6.00 USD depending on your performance.<br>
			Hence, the <b>expected payment is something around $6.00 to $7.00</b>.
	  
			<h3>Confidentiality</h3>
			Your participation in this study will remain confidential.
			Your MTurk worker ID will NOT be shared with anyone outside the research team.
	  
			<h3>Participation and withdrawal</h3>
			Your participation in this study is completely voluntary and you may refuse to participate<br>
			or you may choose to withdraw at any time.<br>
			However, you will only be paid for the participation upon completion<br>
			and if you enter the correct completion code to Mturk (provided at the end of the study).
	  
			<h3>How to contact the researchers</h3>
			If you have questions or concerns about your participation or payment
			or want to request a summary of research findings,
			please email the <a href="mailto:cpilab@tuebingen.mpg.de">researcher</a>
			or the <a href="mailto:eric.schulz@tuebingen.mpg.de">principal investigator</a> (Dr. Eric Schulz).
	  
			
			<h2>Data protection</h2>
			Your data will be anonymized and only used in the manner described in our data protection sheet,
			available <a href="https://kyblab.tuebingen.mpg.de/roulecity/data_protection.pdf" target="_blank">here</a> 
			(please do not fill out this sheet!).
			The following text box summarizes the main points. Please read it carefully and provide consent below:<br>
			<br>
			
			<textarea rows="10" cols="150" readonly>
The processing and use of the collected data occurs in a pseudoanonymized form within the scope of the legally prescribed provisions.
As a general rule, the storage occurs in the form of answered questionnaires, as well as electronic data, for a duration of 10 years or longer, if this is required by the purpose of the study.

By providing of further personal data in pseudoanonymized form, collected personal data may be used for the preparation of anonymized
scientific research work and may also be published and used in an anonymized form in medical journals and scientific publications, so that a direct assignment to my person cannot be established.

The information obtained during the course of this study may also be sent in an anonymized form to cooperation partners within the scope of
the European General Data Protection Regulation for scientific purposes and to cooperation partners outside of the European Union, i.e. to countries with a lower data protection level (this also applies to the USA).

The data collected within the scope of the study can also be used and processed in the future inside of the Max Planck Institute.

I was informed about my rights, that at any time:

I can withdraw this declaration of consent.

I can request information about my stored data and request the correction or blocking of data.

By cancellation of my participation in the study,
I can request that any personal data of mine collected until that point are immediately deleted or anonymized.

I can request that my personal data are handed out to me or to third parties (if technically feasible).

I herewith declare that:

I have been adequately informed about the collection and processing of my personal data and rights.

I consent to the collection and processing of personal data within the scope of the study and its pseudoanonymized disclosure,
so that only the persons conducting the study can establish a link between the data and my person.

Agreement:

I agree to participate in this experiment.

I consent to the use of my data described in the Data Protection Information Sheet
and confirm having received a copy of the Data Protection Sheet.

I consent to data transfer from the MPI for Biological Cybernetics encrypted database to the project-related collaborators:
inside of the Max Planck Society and affiliated research institutes, or at partnering institutions like the University of Tuebingen.
			</textarea>      
			
			<br>
			<br>
			By selecting the consent option below,
			you acknowledge that you fulfill all of the participation criteria
			and you agree to your data being used as described.
			<br>
			<br>
	
			<button type="button" name="button" id="buttonConsentForm" onclick="clickStart('page1','page2');">I consent to participate</button><br><br>

    </div>  

	<!--Introduce Bandit City-->
	<div id="page2" style="display:none">
		<br>
			<p><b>Welcome!</b></p>
			<ul>
			<li>Today, you are going be a gambler visiting the fictional town of Bandit City (BC).</li>
			<li>BC is the place to be if you wish to immerse yourself in the world of gambling.</li>
			<li>Like any major gambling city, BC has several casinos lined up next to one another.</li>
			<li>As an experienced gambler, you like to visit all the casinos whenever you are in town and make some money.</li>
			</ul>
		<br>			   
		<button type="button" name="button"; onclick="clickStart('page2','page3')"; >Go to next page</button>
	</div>

	<!--Tasks-->
	<div id="page3" style="display:none">
		<br>
			<p><b>Local News!</b></p>
			<ul>
			<li>To promote local businesses, casinos in BC recently decided to buy a new type of slot machines from their local manufactures.</li>
			<li>So all casinos now have two new slot machines, one each from Green Geeks and Blue Lagoons.</li>
			<li>Let us take a look at these new machines.</li>
			</ul>
		<br>			   
		<button type="button" name="button"; onclick="clickStart('page3','page4a')"; >Go to next page</button>
	</div>

	<!--MAB-->
	<div id="page4a" style="display:none">
		<br>
			<p><b>Slot Machine 2.0</b></p>
			<ul>
			<li> Each slot machine has several options that you can choose from to earn BC coins. </li>
			<li> Each option maps on to different keys on your keyboard. </li>
			<li> You can choose an option by pressing the corresponding key on your keyboard. </li>
			<li> Color of the keys indicate the company it was made by. </li> 
			It could be green, made by Green Geeks:
			<br><img src="figs/Green_arms.png" width="600" ><br>
			Or blue, made by Blue Lagoons:
			<br><img src="figs/Blue_arms.png" width="600" ><br>
			<li> When you have made a choice, the key you pressed becomes bold and the amount of BC coins you won will appear on the screen. </li>
			</ul>		
		<br>			   
		<button type="button" name="button"; onclick="clickStart('page4a','page4b')"; >Go to next page</button>
	</div>

	<!--MAB-->
	<div id="page4b" style="display:none">
		<br>
			<p><b>Slot Machines 2.0</b></p>
			<ul>
			<li> The number of BC coins you can get is different for the different keys of the slot machine. </li>
			<li> You have 5 chances to try and find the most rewarding option. </li>
			<li> The earlier you find the most rewarding option for a given machine, the more BC coins you can earn from it. </li>
			<li> Since you feel quite motivated, you will play all the different types of slot machines in a casino before moving to the next casino. </li>
			<li> You will exchange all the BC coins you earned across casinos for real money at the end of your adventure. </li>
			</ul>
		<br>			   
		<button type="button" name="button"; onclick="clickStart('page4b','page5a')"; >Go to next page</button>
	</div>
	<!--sMAB-->
	<div id="page5a" style="display:none">
		<br>
			<p><b>Shhh...</b></p>
			<ul>
			<li> During his visit to BC last weekend, a friend of yours had an "Aha" moment! </li>
			<li> As he went from casino to casino, he noticed that slot machines from the same company behaved somewhat similarly. </li>
			<li> He realized that the coins he could get by pressing the different options on a slot machine followed a certain pattern. </li>
			<li> It was as if the companies preset the coins one could earn from each option to these patterns before delivering it. </li>
			</ul>
		<br>			   
		<button type="button" name="button"; onclick="clickStart('page5a','page5b')"; >Go to next page</button>
	</div>

	<!--sMAB-->
	<div id="page5b" style="display:none">
		<br>
			<p><b>Hmm...but what trends?</b></p>
			<ul>
			<li> He noted that all machines made by a company is preset to one of the two trends: </li>
			<h5> 1. Rising/Falling Trend </h5>
			<li> For machine from one company, he could get more and more (Left) or less and less (Right) BC coins as he went from key S (left-most) to key L (right-most) as shown below. </li>
			<br><img src="figs/LinPos1.png" width="280" > <img src="figs/LinNeg1.png" width="280" ><br> 
			<li> Note that machines from this company could be rising in one casino and falling in the other but across casinos, all their machines (i.e. same colored) will belong only to the rising/falling trend. </li>
			<h5> 2. Alternating Trend </h5>
			<li> For machines from the another company, he saw that every other option was highly rewarding so either keys (S, F, K) or (D, J, L) were more rewarding as shown below. </li>
			<br><img src="figs/PerEven1.png" width="280" > <img src="figs/PerOdd2.png" width="280" > <br>
			<li> Again, whether a machine of this company is preset to (S, F, K) or (D, J, L) to be highly rewarding could change between casinos but all machines from this company belonged only to the alternating trend.</li>	
			<!-- <br><img src="figs/LinNeg1.png" width="300" ><br> -->
			<!-- <li> Let us assume hypothetically that machines from Blue Lagoons followed Rising/Falling Trend </li>
			<li> Then, the coins you caan get for the different options on blue machines can be either rising or falling and you can only know which of the two by playing against it.  </li>
			-->
			</ul>
		<br>			   
		<button type="button" name="button"; onclick="clickStart('page5b','page5c')"; >Go to next page</button>
	</div>

	<div id="page5c" style="display:none">
		<br>
			<p><b>Trends are not fixed?</b></p>
			<ul>
			<h5> The degree of rise and fall are not the same in every casino. </h5>
			<li> For example, you can see two different rising trends below. </li>
			<br><img src="figs/LinPos1.png" width="280" > <img src="figs/LinPos2.png" width="280" ><br> 
			<li> For example, you can see two different falling trends below. </li>
			<br><img src="figs/LinNeg1.png" width="280" > <img src="figs/LinNeg2.png" width="280" ><br> 
			<!-- <li> Let us assume hypothetically that machines from Blue Lagoons now followed Alternate Trend </li>
			<li> Then, blue machines can have keys (S, F, K) as highly rewarding or  keys (J, K, L) and again, you can only know which of the two by playing against it.  </li> -->
			</ul>
		<br>			   
		<button type="button" name="button"; onclick="clickStart('page5c','page5d')"; >Go to next page</button>
	</div>

	<div id="page5d" style="display:none">
		<br>
			<p><b>Patterns are not fixed?</b></p>
			<ul>
			<h5> Same goes for alternating functions, they might not be as highly rewarding in every casino.</h5>
			<li> For example, you can see two different (D, J, L) alternating trend below. </li>
			<br><img src="figs/PerOdd2.png" width="280" > <img src="figs/PerOdd1.png" width="280" ><br>
			<li> For example, you can see two different (S, F, K) alternating trend below. </li>
			<br><img src="figs/PerEven1.png" width="280" > <img src="figs/PerEven2.png" width="280" ><br>
			<!-- <li> Let us assume hypothetically that machines from Blue Lagoons now followed Alternate Trend </li>
			<li> Then, blue machines can have keys (S, F, K) as highly rewarding or  keys (J, K, L) and again, you can only know which of the two by playing against it.  </li> -->
			</ul>
		<br>			   
		<button type="button" name="button"; onclick="clickStart('page5d','page6')"; >Go to next page</button>
	</div>

	<!--Task purpose-->
	<div id="page6" style="display:none">
		<br>
			<p><b>Your mission</b></p>
			<ul>
			<li> Unfortunately, your buddy went a little out of control that night, what happens in BC stays in BC. </li>
			<li> Now, he only remembers the trends and does not recollect which trend belongs to which company. </li>
			<li> Good news is that if you can figure out this, you can end up leaving BC a rich man. </li>
			<!-- <li> Remember, the trend followed by a slot machine i.e. Linear or Alternate remains same as you go from casino to casino. </li> -->
			<!-- <li> After you visited all the casinos, you can exchange all the BC coins you have collected for real money. </li> -->
			</ul>
		<br>			   
		<button type="button" name="button"; onclick="ConditionSwitch('page6')"; >Go to next page</button>
	</div>

	<!--Condition based: Compositional-->
	<div id="page7a" style="display:none">
		<br>
			<p><b>Oh wait!</b></p>
			<ul>			
			<li> Looks like the casino owners have caught on to us, they noticed that a lot of people were doing well on the new slot machines. </li>
			<li> They now want to challenge their visitors by making it harder to earn BC coins. </li>
			<li> So, once you finish playing against the two slot machines, they would connect the machines together and ask you to play against the connected slot machine. </li>
			<li> The machines were connected such that pressing a button on one would result in pressing the same button on the other. </li>
			<li> The options for such a connected machine will be half-green and half-blue as shown below. </li>
			<br><img src="figs/GW_buttons.png" width="600" ><br>
			<li> The total coins you earn by choosing an option on such a machine is the sum of coins from the two slot machines. </li>
			<li> Unlike your friend, you will be playing against three slot machines in each casino today. </li>
			<li> Hope you are up for the challenge! </li>
			</ul>
		<br>			   
		<button type="button" name="button"; onclick="clickStart('page7a','page8')"; >Go to next page</button>
	</div>

	<!--Condition based: Non-Compositional-->
	<div id="page7b" style="display:none">
		<br>
			<p><b>Oh wait!</b></p>
			<li> Looks like the casino owners have caught on to us, they noticed that a lot of people were doing well on the new slot machines. </li>
			<li> They now want to challenge their visitors by making it harder to earn BC coins. </li>
			<li> So, they connected the machines together and asked people to play against the connected slot machine instead. </li>
			<li> The machines were connected such that pressing a button on one would result in pressing the same button on the other. </li>
			<li> The options for such a connected machine will be half-green and half-blue as shown below. </li>
			<br><img src="figs/GW_buttons.png" width="600" ><br>
			<li> The total coins you earn by choosing an option on such a machine is the sum of coins from the two slot machines. </li>
			<li> Unlike your friend, you will be playing only one machine in each casino today. </li>
			<li> Hope you are up for the challenge!</li>
			</ul>
		<br>			   
		<button type="button" name="button"; onclick="clickStart('page7b','page8')"; >Go to next page</button>
	</div>

	<!--Sixth page contains keyboard layout-->
	<div id="page8" style="display:none">
		<br>
			<p><b>Keyboard finger position:</b></p>
					<ul>
					<li>We kindly ask you to place your hands on the keyboard as shown in the picture below.</li>
					<li>Please use your left hand to select the options <b>S</b>, <b>D</b> or <b>F</b>. Use your right hand to select <b>J</b>, <b>K</b> or <b>L</b>.</li>
					<li>Please use your left index finger to select <b>F</b>, and your right index finger to select <b>J</b>, and so forth.</li>
				</ul>
			<br>
			<img src="figs/fingerposition.png" width="600" ><br><br>
			<button type="button" name="button"; onclick="clickStart('page8','page9')"; >Go to next page</button>  
		<br>
	</div>

	<!--Seventh page contains comprehension check-->
	<div id="page9" style="display:none">
		<fieldset>
			<legend>Please answer a few questions about this study before proceeding</legend>
			<fieldset style="float:left;width:400px;margin:5px">
				What is your goal when you visit a casino?<br>
				<input type="radio" name="q1"  > Try out all options on every slot machine in the casino.<br>
				<input type="radio" name="q1" id="icheck1" > Gain as many BC coins as possible from each slot machine.<br>
				<input type="radio" name="q1" > Pick an arbitary option in every try.<br>
				<input type="radio" name="q1" > I do not know.<br>
			</fieldset>
			<fieldset style="float:left;width:400px;margin:5px">
				How many slot machines will you play against in each casino?<br>
				<input type="radio" name="q2"> Changes every casino. <br>
				<input type="radio" name="q2"> 2 <br>
				<input type="radio" name="q2" id="icheck2"> <span id="casino_id"> 1 </span> <br>
				<input type="radio" name="q2"> I am not sure. <br>
			</fieldset>
			<fieldset style="float:left;width:400px;margin:5px">
				Let us say a machine from GreenGeeks followed a rising trend in a casino, what trend will another machine from them follow in the next casino?<br>
				<input type="radio" name="q3">  
					Rising trend again.<br>
				<input type="radio" name="q3" id="icheck3"> 
					Either rising or falling, one needs to figure out which.<br>
				<input type="radio" name="q3"> 
					Falling trend for sure.<br>
				<input type="radio" name="q3"> 
					Either rising, falling or alternating, one needs to figure out which.<br>
			</fieldset>
			<fieldset style="float:left;width:400px;margin:5px">
				What does pressing an option that is half-green and half-blue mean?<br>
				<input type="radio" name="q4">  
					Simulates pressing the option on either green or blue machine, you do not know which. <br>
				<input type="radio" name="q4" id="icheck4"> 
					Simulates pressing the same option on both machines simultaneously. <br>
				<input type="radio" name="q4"> 
					Indicates a completely new slot machine unrelated to previous slot machines.<br>
				<input type="radio" name="q4"> 
					Indicates an issue with the machine. <br>
			</fieldset>
		</fieldset>
		<br><br><br><br>
		<p>You will only be directed to the next page if you manage to answer all of the questions correctly.</p>
		<button type="button" name="button"; onclick="instructioncheck()"; >Check answers</button>  
	</div>

	<!--task-->
	<div id="page10" style="display:none">
		<h1> <font size="4">Please choose an option to gain BC coins.</font> </h1>
		<div id="explainshow" style="display:none">
			<p> <b>Summarized Instructions:</b></p>
			<p><b>I.</b> Below, there are 6 different options marked by different letters. When you press the letter/symbol of a particular option on your keyboard, the number of BC coins you earn for that option will be revealed and will be displayed below for 2 seconds. </p>
			<p><b>II.</b> Options can be repeatedly chosen, although there may be small variations in the BC coins earned.</p>
			<p><b>III.</b> Every option can lead to different amounts of BC coins. Your task is to earn as many coins as possible by selecting valuable options. </p>
			<p><b>IV.</b> On top of the options, you can see how many tries you have left for the current slot machine and the amount of coins you have earned so far.</p>
			<p><b>V.</b> The options are colored based on the company that manufactured it. Knowing what these colors indicate can help you to gain more coins.</p>				
			<button type="button" name="button"; onclick="clickStart('explainshow','explainhide')"; >Hide guidelines</button>
		</div>
		<div id="explainhide" style="display:block">
			<button type="button" name="button"; onclick="clickStart('explainhide','explainshow')"; >Show guidelines</button>
		</div>
		<div id="begintask" style="display:block">
			<center>
				<b><h3><div id="remain">Number of trials left: 5</div></h3></b>
				<b><h3><div id="score">Total Coins Earned: 0.0</div></h3></b></b>
				<div id="feature"></div></b></b>
				<div id='arm1' style="display: inline"></div>
				<div id='arm2' style="display: inline"></div>
				<div id='arm3' style="display: inline"></div>
				<div id='arm4' style="display: inline"></div>
				<div id='arm5' style="display: inline"></div>
				<div id='arm6' style="display: inline"></div>
				<div id='arm7' style="display: inline"></div>
				<div id='arm8' style="display: inline"></div><br>        
				<div id="next" style="display: block">
				<b><h3><div id="outcome">Please choose an option!</div></h3></b>
				</div>
			</center>   
		</div>
	</div>

	<div id="showperformance" style="display:none">
		<center>
			<b><h4><div id="numtasks"> Casino 0 out of 20 now visited.</div></h4></b>
			<b><h4><div id="percentreward"> You earned 0% of maximum possible BC coins in the last casino.</div></h4></b>
			<b><h5><div>Please click on "Next Casino" to continue.</div></h5></b>
			<button type="button" name="button"; onclick="clickStart('showperformance','page10')"; >Next Casino</button>
		</center>
	</div>

	<!--demographics-->
	<div id="page11" style="display:none">
		<h1> <font size="4">Please tell us something about yourself.</font> </h1>
		<fieldset>
			<div style="float:left;width:400px;margin:5px">
				How old are you?<br>
				<input id="age" type="radio" name="age" onclick="setage(20)" >18-25<br>
				<input id="age" type="radio" name="age" onclick="setage(30)" >26-35<br>
				<input id="age" type="radio" name="age" onclick="setage(40)" >36-50<br>
				<input id="age" type="radio" name="age" onclick="setage(50)" >above 50<br>
			</div>
			<div style="float:left;width:400px;margin:5px">
				What's your gender?<br>
				<input id="gender" type="radio" name="gender" onclick="setgender(0)" >Female<br>
				<input id="gender" type="radio" name="gender" onclick="setgender(1)" >Male<br>
				<input id="gender" type="radio" name="gender" onclick="setgender(2)" >Diverse<br>
			</div>
			<div style="float:left;width:400px;margin:5px">Handedness?<br>
				<input type="radio" name="handed" value="1" >Right<br>
				<input type="radio" name="handed" value="2" >Left<br>
			</div>
		</fieldset>
		<div style="width:50px;margin:0 auto">
			<button type="button" name="button"; onclick="mysubmit()"; >Done</button>
		</div>
	
		<!--Tenth page contains results and code word-->
	</div>

	<!-- renumeration -->
	<div id="page12" style="display:none">
		<h1><font size="4">Your performance and reward</font></h1>
		<div id="result"></div><br>
		<div id="money"></div><br>
		<p>Thank you very much for participating in our study.</p>
		<p>Your Mechanical Turk Password is:<br> <b>compbandits</b></p><br>
		<p>In case you have any questions, please contact us via our MTurk account or write an email to<br> <b>akshay.jagadish@tue.mpg.de</b></p>
	</div>
</div>

<script src="js/compositionalbandit.js" charset="utf-8"></script>
</body>

</html>
